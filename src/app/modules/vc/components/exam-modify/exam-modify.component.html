<ng-button class="my-4" [full]="true" [label]="'room.questionsArchive' | translate" icon="pi pi-angle-left"
           (click)="isOpen = !isOpen" type="button" cdkOverlayOrigin #trigger="cdkOverlayOrigin"
></ng-button>

<!--(click)="archive.toggle($event)"-->
<form [formGroup]="form">
  <ng-input-textarea [rtl]="fa" class="d-block mb-3" [placeholder]="'room.enterYourQuestion' | translate"
                     formControlName="question"></ng-input-textarea>
  <ng-container formArrayName="answers">
    <ng-container [formGroupName]="i" *ngFor="let item of $any(form.get('answers')).controls;let i = index">
      <div class="d-flex align-items-center mb-3">
        <ng-single-checkbox formControlName="isCorrect"></ng-single-checkbox>
        <ng-input-text [rtl]="fa" [placeholder]="'room.enterYourOption' | translate" class="mx-2"
                       formControlName="text"></ng-input-text>
        <ng-button *ngIf="i > 1" color="danger" appearance="text" icon="pi pi-trash" (click)="deleteAnswer(i)"
                   size="sm"></ng-button>
      </div>
    </ng-container>
  </ng-container>

  <ng-button iconPos="right" appearance="text" icon="pi pi-plus" (click)="addAnswer()" size="sm"
             [label]="'add' | translate"></ng-button>
</form>
<div class="footer text-left mt-4">
  <ng-button (click)="onSubmit()" [label]="'room.publish' | translate"></ng-button>
</div>

<ng-template
  cdkConnectedOverlay
  [cdkConnectedOverlayOrigin]="trigger"
  [cdkConnectedOverlayOpen]="isOpen"
>
  <div [exclude]="'ng-button'" (clickOutside)="isOpen = false" class="wrapper shadow border p-3 rounded bg-light">
    <p-accordion>
      <p-accordionTab *ngFor="let q of questions;let i = index" [header]="q.title"
                      [selected]="questionsActiveStates[i]">
        <p-table [value]="q.answers" responsiveLayout="scroll">
          <ng-template pTemplate="header">
            <tr>
              <th>{{'room.answers' | translate}}</th>
              <th>{{'room.people' | translate}}</th>
              <th>{{'room.percent' | translate}}</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-a>
            <tr>
              <td>{{a.code}}</td>
              <td>{{a.name}}</td>
              <td>{{a.category}}</td>
            </tr>
          </ng-template>
        </p-table>
      </p-accordionTab>
    </p-accordion>
  </div>
</ng-template>
<p-overlayPanel appendTo="body" styleClass="question-report" #archive>
  <p-accordion>
    <p-accordionTab *ngFor="let q of questions;let i = index" [header]="q.title" [selected]="questionsActiveStates[i]">
      <p-table [value]="q.answers" responsiveLayout="scroll">
        <ng-template pTemplate="header">
          <tr>
            <th>{{'room.answers' | translate}}</th>
            <th>{{'room.people' | translate}}</th>
            <th>{{'room.percent' | translate}}</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-a>
          <tr>
            <td>{{a.code}}</td>
            <td>{{a.name}}</td>
            <td>{{a.category}}</td>
          </tr>
        </ng-template>
      </p-table>
    </p-accordionTab>
  </p-accordion>
</p-overlayPanel>
